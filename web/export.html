<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Export Tools - ScheduleFlow</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body class="theme-black">
    <nav class="navbar">
        <div class="nav-container">
            <h1 class="logo">âš¡ ScheduleFlow</h1>
            <div class="nav-links">
                <a href="index.html" class="nav-link">Hub</a>
                <a href="scheduler.html" class="nav-link">Scheduler</a>
                <a href="demo.html" class="nav-link">Demo</a>
                <a href="calendar.html" class="nav-link">Calendar</a>
                <a href="export.html" class="nav-link active">Export</a>
            </div>
        </div>
    </nav>

    <main class="container">
        <h1>Export Tools</h1>
        <p>Export your schedule to various playout engines and formats.</p>

        <section class="export-section">
            <h2>Supported Export Formats</h2>
            
            <div class="export-card">
                <h3>CasparCG Format</h3>
                <p>Professional playout engine XML format for broadcast facilities.</p>
                <button class="btn-primary" onclick="exportTools.exportCasparCG()">Export for CasparCG</button>
            </div>

            <div class="export-card">
                <h3>OBS (Open Broadcaster Software)</h3>
                <p>Playlist format compatible with OBS streaming engine.</p>
                <button class="btn-primary" onclick="exportTools.exportOBS()">Export for OBS</button>
            </div>

            <div class="export-card">
                <h3>M3U Playlist</h3>
                <p>Standard M3U8 playlist format for media players.</p>
                <button class="btn-primary" onclick="exportTools.exportM3U()">Export M3U</button>
            </div>

            <div class="export-card">
                <h3>JSON Schedule</h3>
                <p>Structured JSON format for programmatic access.</p>
                <button class="btn-primary" onclick="exportTools.exportJSON()">Export JSON</button>
            </div>
        </section>

        <section class="export-section">
            <h2>Preview & Copy</h2>
            <div class="preview-container">
                <textarea id="exportPreview" placeholder="Select an export format to see preview..." readonly rows="12"></textarea>
            </div>
            <div class="controls">
                <button class="btn-secondary" onclick="exportTools.copyPreview()">ðŸ“‹ Copy to Clipboard</button>
                <button class="btn-secondary" onclick="exportTools.clearPreview()">Clear</button>
            </div>
        </section>

        <section class="export-section">
            <h2>Export Configuration</h2>
            <div class="config-form">
                <label>
                    Channel Name:
                    <input type="text" id="channelName" value="ScheduleFlow Channel" placeholder="Your channel name">
                </label>
                <label>
                    Include Metadata:
                    <input type="checkbox" id="includeMetadata" checked>
                </label>
                <label>
                    Time Zone:
                    <select id="timezone">
                        <option value="UTC">UTC</option>
                        <option value="EST">EST</option>
                        <option value="CST">CST</option>
                        <option value="MST">MST</option>
                        <option value="PST">PST</option>
                    </select>
                </label>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 ScheduleFlow. Professional Export Ready.</p>
    </footer>

    <script>
        const exportTools = {
            getSampleSchedule() {
                return JSON.parse(localStorage.getItem('scheduleData') || '[]') || [
                    { time: '08:00', item: { title: 'Breaking Bad S01E01', url: 'http://example.com/bb1.mp4' } },
                    { time: '09:00', item: { title: 'Documentary 01', url: 'http://example.com/doc1.mp4' } },
                    { time: '10:00', item: { title: 'Classic Film 1', url: 'http://example.com/film1.mp4' } }
                ];
            },

            exportCasparCG() {
                const schedule = this.getSampleSchedule();
                const channel = document.getElementById('channelName').value;
                
                let xml = '<?xml version="1.0" encoding="UTF-8"?>\n';
                xml += '<Channel>\n';
                xml += `  <Name>${channel}</Name>\n`;
                xml += '  <Playlists>\n';
                
                for (let slot of schedule) {
                    xml += '    <Clip>\n';
                    xml += `      <Time>${slot.time}</Time>\n`;
                    xml += `      <Title>${this.escapeXml(slot.item.title)}</Title>\n`;
                    xml += `      <URL>${this.escapeXml(slot.item.url)}</URL>\n`;
                    xml += '    </Clip>\n';
                }
                
                xml += '  </Playlists>\n';
                xml += '</Channel>';
                
                document.getElementById('exportPreview').value = xml;
                this.showMessage('CasparCG format generated');
            },

            exportOBS() {
                const schedule = this.getSampleSchedule();
                
                let obs = '{\n';
                obs += '  "scenes": [\n';
                obs += '    {\n';
                obs += '      "name": "ScheduleFlow Broadcast",\n';
                obs += '      "sources": [\n';
                
                for (let i = 0; i < schedule.length; i++) {
                    const slot = schedule[i];
                    obs += `        {\n`;
                    obs += `          "id": "source_${i}",\n`;
                    obs += `          "name": "${slot.item.title}",\n`;
                    obs += `          "type": "media_source",\n`;
                    obs += `          "file": "${slot.item.url}",\n`;
                    obs += `          "start_time": "${slot.time}"\n`;
                    obs += `        }${i < schedule.length - 1 ? ',' : ''}\n`;
                }
                
                obs += '      ]\n';
                obs += '    }\n';
                obs += '  ]\n';
                obs += '}';
                
                document.getElementById('exportPreview').value = obs;
                this.showMessage('OBS format generated');
            },

            exportM3U() {
                const schedule = this.getSampleSchedule();
                let m3u = '#EXTM3U\n';
                
                for (let slot of schedule) {
                    m3u += `#EXTINF:-1,${slot.item.title}\n`;
                    m3u += `${slot.item.url}\n`;
                }
                
                document.getElementById('exportPreview').value = m3u;
                this.showMessage('M3U format generated');
            },

            exportJSON() {
                const schedule = this.getSampleSchedule();
                const channel = document.getElementById('channelName').value;
                const includeMetadata = document.getElementById('includeMetadata').checked;
                const timezone = document.getElementById('timezone').value;
                
                const json = {
                    channel: channel,
                    timezone: timezone,
                    exported: new Date().toISOString(),
                    schedule: schedule,
                    metadata: includeMetadata ? {
                        total_items: schedule.length,
                        duration_hours: 24,
                        format_version: '1.0'
                    } : undefined
                };
                
                document.getElementById('exportPreview').value = JSON.stringify(json, null, 2);
                this.showMessage('JSON format generated');
            },

            copyPreview() {
                const preview = document.getElementById('exportPreview');
                preview.select();
                navigator.clipboard.writeText(preview.value).then(() => {
                    this.showMessage('Copied to clipboard!');
                });
            },

            clearPreview() {
                document.getElementById('exportPreview').value = '';
            },

            escapeXml(str) {
                return str.replace(/[<>&'"]/g, (c) => {
                    switch (c) {
                        case '<': return '&lt;';
                        case '>': return '&gt;';
                        case '&': return '&amp;';
                        case '"': return '&quot;';
                        case "'": return '&apos;';
                        default: return c;
                    }
                });
            },

            showMessage(msg) {
                const status = document.createElement('div');
                status.style.cssText = 'position: fixed; top: 20px; right: 20px; background: #00ff00; color: #000; padding: 1rem; border: 2px solid #ffff00; z-index: 1000;';
                status.textContent = msg;
                document.body.appendChild(status);
                setTimeout(() => status.remove(), 3000);
            }
        };
    </script>

    <style>
        .export-section {
            margin: 3rem 0;
            padding: 2rem;
            border: 2px solid #00ff00;
            background-color: #1a1a1a;
        }

        .export-section h2 {
            color: #ffff00;
            margin-bottom: 2rem;
        }

        .export-card {
            background-color: #333;
            border: 1px solid #00ff00;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: all 0.3s;
        }

        .export-card:hover {
            border-color: #ffff00;
            background-color: rgba(255, 255, 0, 0.05);
        }

        .export-card h3 {
            color: #ffff00;
            margin-bottom: 0.5rem;
        }

        .export-card p {
            color: #00ff00;
            margin-bottom: 1rem;
            font-size: 0.95rem;
        }

        .preview-container {
            margin: 1.5rem 0;
        }

        .controls {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 1.5rem;
        }

        .config-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .config-form label {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            color: #00ff00;
        }

        .config-form input,
        .config-form select {
            flex: 1;
        }

        @media (max-width: 768px) {
            .export-section {
                padding: 1rem;
            }

            .controls {
                flex-direction: column;
            }
        }
    </style>
</body>
</html>
